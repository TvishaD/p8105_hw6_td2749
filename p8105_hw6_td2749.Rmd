---
title: "p8105_hw6_td2749"
author: "Tvisha R. Devavarapu"
date: "2022-11-22"
output: github_document
---

```{r setup, message = FALSE}
library(tidyverse)
library(ggplot2)

knitr::opts_chunk$set(
  fig.width = 10,
  fig.asp = .6,
  out.width = "90%")
```

# Problem 2

```{r homicide_data set up}
homicide_data = 
  read_csv("./data/homicide-data.csv") %>%
  janitor::clean_names() %>% 
  unite(city_state, c(city, state), sep = ",", remove = FALSE) %>% 
  mutate(
    resolved = ifelse(disposition == "Closed by arrest", 1, 0),
    victim_age = as.numeric(victim_age),
    victim_sex = as.factor(victim_sex)) %>% 
  filter(
    !(city_state %in% c("Dallas,TX", "Phoenix,AZ", "Kansas City,MO", "Tulsa,AL")),
    victim_race %in% c("White", "Black")) %>% 
  mutate(
    victim_race = as.factor(victim_race))

head(homicide_data)
```

**Note**: In the `homicide_data` df, column `resolved` indicates the case status. Cases that are closed by arrest (solved cases) are represented by 1 and cases that are open/no-arrest and closed without arrest (unsolved cases) are represented by 0. 

```{r blatimore glm for logistic fit}
balt_log_fit = 
  homicide_data %>% 
  filter(
    city_state == "Baltimore,MD") %>% 
  glm(resolved ~ victim_age + victim_sex + victim_race, data = ., family = binomial())

balt_log_fit_table = broom::tidy(balt_log_fit)

balt_log_fit_table %>% 
  mutate(OR = exp(estimate)) %>%
  select(term, log_OR = estimate, OR, p.value) %>% 
  knitr::kable(digits = 3)

male_vic_OR = exp(coef(balt_log_fit))[["victim_sexMale"]]
male_vic_OR_lower = exp(confint(balt_log_fit, "victim_sexMale"))[[1]]
male_vic_OR_upper = exp(confint(balt_log_fit, "victim_sexMale"))[[2]]
```

and obtain the estimate and confidence interval of the adjusted odds ratio for solving homicides comparing male victims to female victims keeping all other variables fixed.





